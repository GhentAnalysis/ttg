# defaultSelections = ['llg-mll40-offZ-llgNoZ-signalRegion-photonPt20:SYS,POST']

defaultSelections = ['llg-mll40-photonPt20',
                     'llg-mll40-signalRegion-photonPt20:SYS',
                     'llg-mll40-offZ-llgNoZ-photonPt20:SYS,POST',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt20:SYS,POST',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt30',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt40',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt50',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt60',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt70',
                     'llg-mll40-offZ-llgNoZ-njet1-deepbtag0-photonPt20',
                     'llg-mll40-offZ-llgNoZ-njet1-deepbtag1p-photonPt20',
                     'llg-mll40-offZ-llgNoZ-njet2p-photonPt20',
                     'llg-mll40-offZ-llgNoZ-njet2p-deepbtag0-photonPt20',
                     'llg-mll40-offZ-llgNoZ-njet2p-deepbtag1-photonPt20',
                     'llg-mll40-offZ-llgNoZ-njet2p-deepbtag1p-photonPt20',
                     'llg-mll40-offZ-llgNoZ-njet2p-deepbtag1p-photonPt20-phMVA0.20',
                     'llg-mll40-offZ-llgNoZ-njet2p-deepbtag2p-photonPt20',
                     'llg-mll40-orOnZ-photonPt20',
                     'llg-mll40-onZ-photonPt20',
                     'llg-mll40-llgOnZ-photonPt20:SYS,POST',
                     'llg-mll40-llgOnZ-signalRegion-photonPt20:SYS,POST',
                     'llg-mll40-llgOnZ-njet1p',
                     'llg-mll40-llgOnZ-njet2p',
                     ]

# defaultSelections = ['llg-mll40-photonPt20',
#                     #  'llg-mll40-signalRegion-photonPt20:SYS',
#                     #  'llg-mll40-offZ-llgNoZ-photonPt20:SYS,POST',
#                      'llg-mll40-offZ-llgNoZ-signalRegion-photonPt20:SYS,POST',
#                     #  'llg-mll40-offZ-llgNoZ-signalRegion-photonPt30',
#                     #  'llg-mll40-offZ-llgNoZ-signalRegion-photonPt40',
#                     #  'llg-mll40-offZ-llgNoZ-signalRegion-photonPt50',
#                     #  'llg-mll40-offZ-llgNoZ-signalRegion-photonPt60',
#                     #  'llg-mll40-offZ-llgNoZ-signalRegion-photonPt70',
#                     #  'llg-mll40-offZ-llgNoZ-njet1-deepbtag0-photonPt20',
#                     #  'llg-mll40-offZ-llgNoZ-njet1-deepbtag1p-photonPt20',
#                     #  'llg-mll40-offZ-llgNoZ-njet2p-photonPt20',0
#                     #  'llg-mll40-offZ-llgNoZ-njet2p-deepbtag0-photonPt20',
#                     #  'llg-mll40-offZ-llgNoZ-njet2p-deepbtag1-photonPt20',
#                      'llg-mll40-offZ-llgNoZ-njet2p-deepbtag1p-photonPt20',
#                     #  'llg-mll40-offZ-llgNoZ-njet2p-deepbtag2p-photonPt20',
#                      'llg-mll40-orOnZ-photonPt20',
#                     #  'llg-mll40-onZ-photonPt20',
#                     #  'llg-mll40-llgOnZ-photonPt20:SYS,POST',
#                     #  'llg-mll40-llgOnZ-signalRegion-photonPt20:SYS,POST',
#                     #  'llg-mll40-llgOnZ-njet1p',
#                     #  'llg-mll40-llgOnZ-njet2p',
#                      ]


regionsSelections = ['llg-mll40-offZ-llgNoZ-njet1-deepbtag0-photonPt20',
                    'llg-mll40-offZ-llgNoZ-njet2-deepbtag0-photonPt20',
                    'llg-mll40-offZ-llgNoZ-njet3-deepbtag0-photonPt20',
                    'llg-mll40-offZ-llgNoZ-njet1-deepbtag1-photonPt20',
                    'llg-mll40-offZ-llgNoZ-njet2-deepbtag1-photonPt20',
                    'llg-mll40-offZ-llgNoZ-njet3-deepbtag1-photonPt20',
                    'llg-mll40-offZ-llgNoZ-njet2-deepbtag2-photonPt20',
                    'llg-mll40-offZ-llgNoZ-njet3-deepbtag2-photonPt20',
                    'llg-mll40-offZ-llgNoZ-njet3-deepbtag3-photonPt20',
                    'llg-mll40-offZ-llgNoZ-njet3-deepbtag3-photonPt20',
                    'llg-mll40-offZ-llgNoZ-njet3p-deepbtag3-photonPt20',
                    'llg-mll40-offZ-llgNoZ-njet3p-deepbtag3p-photonPt20',
                    'llg-mll40-offZ-llgNoZ-njet1-photonPt20',
                    'llg-mll40-offZ-llgNoZ-njet2-photonPt20',
                    'llg-mll40-offZ-llgNoZ-njet3-photonPt20',
                    'llg-mll40-llgOnZ-njet1-deepbtag0-photonPt20',
                    'llg-mll40-llgOnZ-njet2-deepbtag0-photonPt20',
                    'llg-mll40-llgOnZ-njet3-deepbtag0-photonPt20',
                    'llg-mll40-llgOnZ-njet1-deepbtag1-photonPt20',
                    'llg-mll40-llgOnZ-njet2-deepbtag1-photonPt20',
                    'llg-mll40-llgOnZ-njet3-deepbtag1-photonPt20',
                    'llg-mll40-llgOnZ-njet2-deepbtag2-photonPt20',
                    'llg-mll40-llgOnZ-njet3-deepbtag2-photonPt20',
                    'llg-mll40-llgOnZ-njet3-deepbtag3-photonPt20',
                    'llg-mll40-llgOnZ-njet3-deepbtag3-photonPt20',
                    'llg-mll40-llgOnZ-njet3p-deepbtag3-photonPt20',
                    'llg-mll40-llgOnZ-njet3p-deepbtag3p-photonPt20',
                    'llg-mll40-llgOnZ-njet1-photonPt20',
                    'llg-mll40-llgOnZ-njet2-photonPt20',
                    'llg-mll40-llgOnZ-njet3-photonPt20',
                    'llg-mll40-njet1-deepbtag0-photonPt20',
                    'llg-mll40-njet2-deepbtag0-photonPt20',
                    'llg-mll40-njet3-deepbtag0-photonPt20',
                    'llg-mll40-njet1-deepbtag1-photonPt20',
                    'llg-mll40-njet2-deepbtag1-photonPt20',
                    'llg-mll40-njet3-deepbtag1-photonPt20',
                    'llg-mll40-njet2-deepbtag2-photonPt20',
                    'llg-mll40-njet3-deepbtag2-photonPt20',
                    'llg-mll40-njet3-deepbtag3-photonPt20',
                    'llg-mll40-njet3-deepbtag3-photonPt20',
                    'llg-mll40-njet3p-deepbtag3-photonPt20',
                    'llg-mll40-njet3p-deepbtag3p-photonPt20',
                    'llg-mll40-njet1-photonPt20',
                    'llg-mll40-njet2-photonPt20',
                    'llg-mll40-njet3-photonPt20',
                    ]


diffSelections    = ['llg-mll40-offZ-llgNoZ-signalRegion-photonPt20to30',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt30to50',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt50',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt50',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt20-phJetDeltaR0to0.4',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt20-phJetDeltaR0.4to1',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt20-phJetDeltaR1',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt20-phLepDeltaR0to0.4',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt20-phLepDeltaR0.4to1',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt20-phLepDeltaR1',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt50-phJetDeltaR0to0.4',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt50-phJetDeltaR0.4to1',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt50-phJetDeltaR1',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt50-phLepDeltaR0to0.4',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt50-phLepDeltaR0.4to1',
                     'llg-mll40-offZ-llgNoZ-signalRegion-photonPt50-phLepDeltaR1',
                     'llg-mll40-llgOnZ-signalRegion-photonPt20to30',
                     'llg-mll40-llgOnZ-signalRegion-photonPt30to50',
                     'llg-mll40-llgOnZ-signalRegion-photonPt50',
                     ]

dilepSelections   = ['ll-mll40-offZ:SYS',
                     'll-mll40-offZ-nphoton0:SYS',
                     'll-mll40-offZ-signalRegion:SYS',
                     'll-mll40-offZ-signalRegion-nphoton0:SYS',
                     'll-mll40-offZ-njet2p',
                     'll-mll40-offZ-njet2p-nphoton0',
                     'll-mll40-offZ-njet2p-deepbtag1p',
                     'll-mll40-offZ-njet2p-deepbtag1p-nphoton0'
                     ]

baseSelections   = [
                     'll-mll40-OnZ',
                     'll-mll40-OnZ-njet1p',
                     'll-mll40-OnZ-njet2p',
                     'll-mll40-OnZ-njet2p-deepbtag1p'
                    ]

extraSelections   = [
                    #  'llg-mll40-llgOnZ-njet1p-deepbtag1p-photonPt20',
                    #  'llg-mll40-llgOnZ-njet2p-deepbtag1p-photonPt20',
                    #  'llg-mll40-llgOnZ-njet1p-deepbtag1-photonPt20',
                    #  'llg-mll40-llgOnZ-njet2p-deepbtag1-photonPt20',
                    #  'llg-mll40-llgOnZ-njet1p-deepbtag1p',
                    #  'llg-mll40-llgOnZ',
                    #  'llg-mll40-onZ-njet1p-deepbtag1p-photonPt20',
                    #  'llg-mll40-onZ-njet2p-deepbtag1p-photonPt20',
                    #  'llg-mll40-onZ-njet1p-deepbtag1-photonPt20',
                    #  'llg-mll40-onZ-njet2p-deepbtag1-photonPt20',
                    #  'llg-mll40-onZ-njet1p-deepbtag1p',
                    #  'llg-mll40-onZ',
                    #  'llg-mll40-orOnZ-njet1p-deepbtag1p-photonPt20',
                    #  'llg-mll40-orOnZ-njet2p-deepbtag1p-photonPt20',
                    #  'llg-mll40-orOnZ-njet1p-deepbtag1-photonPt20',
                    #  'llg-mll40-orOnZ-njet2p-deepbtag1-photonPt20',
                    #  'llg-mll40-orOnZ-njet1p-deepbtag1p',
                    #  'llg-mll40-orOnZ'
                    ]

# extraSelections   = [
#                      'llg-mll40-offZ-njet1p-deepbtag1p-photonPt20',
#                      'llg-mll40-offZ-njet2p-deepbtag1p-photonPt20',
#                      'llg-mll40-offZ-njet1p-deepbtag1-photonPt20',
#                      'llg-mll40-offZ-njet2p-deepbtag1-photonPt20',
#                      'llg-mll40-offZ-njet1p-deepbtag1p',
#                      'llg-mll40-offZ-njet1p',
#                      'llg-mll40-offZ',
#                     ]

# extraSelections   = [
#                      'llg-mll40-offZ-njet1p-photonPt20',
#                      'llg-mll40-offZ-njet1p',
#                      'llg-mll40-offZ',
#                      'llg-mll40-offZ-photonPt20',
#                      'llg-mll40-onZ-njet1p-photonPt20',
#                      'llg-mll40-onZ-njet1p',
#                      'llg-mll40-onZ',
#                      'llg-mll40-onZ-photonPt20',
#                      'llg-mll40-llgOnZ-njet1p-photonPt20',
#                      'llg-mll40-llgOnZ-njet1p',
#                      'llg-mll40-llgOnZ',
#                      'llg-mll40-llgOnZ-photonPt20'
#                      'llg-mll40-orOnZ-njet1p-photonPt20',
#                      'llg-mll40-orOnZ-njet1p',
#                      'llg-mll40-orOnZ',
#                      'llg-mll40-orOnZ-photonPt20'
#                     ]

#
# Get the selections to consider for a given tag/channel
# On-Z selection only retained for SF/noData with the default phoCBfull tag
# When running sys or post-fit plots, reduce the selection
#
def getSelections(tag, channel, sys, post):
  if not tag.count('pho'):                              selections = dilepSelections
  elif tag == 'compareWithTT':                          selections = [i for i in dilepSelections if 'photon' not in i]
  elif tag == 'phoCBfull':                              selections = [(s+':SYS,POST') for s in defaultSelections] + diffSelections
  elif tag.count('base'):                               selections = dilepSelections + baseSelections
  else:                                                 selections = defaultSelections
  if tag.lower().count("regions"):                      selections = regionsSelections

  # if tag.count('extra'): selections = extraSelections

# FIXME Why no on-Z plots if not phoCBfull? actual reason these plots would not be ok?
  # if channel not in ['SF', 'noData'] or not tag.count('phoCBfull'):
  if channel not in ['SF', 'noData']:
    selections = [s for s in selections if not s.lower().count('onz')]

  if sys:  selections = [s for s in selections if 'SYS'  in s]
  if post: selections = [s for s in selections if 'POST' in s]



  return [s.split(':')[0] for s in selections]

#
# Get the (selection, channel, sys) variations to consider for the ttgPlots.py script
#
def getVariations(args, sysList):
  if args.channel:                        channels = [args.channel]
  elif args.tag.count('compareChannels'): channels = ['all']
  elif args.tag.count('splitOverlay'):    channels = ['noData']
  elif args.tag.count('misId'):           channels = ['noData']
  elif args.tag.count('compos'):          channels = ['noData']
  elif args.tag.count('samp'):            channels = ['noData']
  elif args.tag.count('randomConeCheck'): channels = ['ee', 'mumu', 'emu', 'SF', 'all']
  elif args.tag.count('igmaIetaIeta'):    channels = ['ee', 'mumu', 'emu', 'SF', 'all', 'noData']
  else:                                   channels = ['ee', 'mumu', 'emu', 'SF', 'all', 'noData']

  variations = []
  for c in channels:
    if args.selection: selections = [args.selection]
    else:              selections = getSelections(args.tag, c, args.runSys or args.showSys, args.post)
    variations += [(sel, c, s) for sel in selections for s in sysList]

  return ('selection', 'channel', 'sys'), variations
